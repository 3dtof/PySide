<?xml version="1.0"?>
<typesystem package="PySide.QtXml">
    <load-typesystem name="typesystem_templates.xml" generate="no" />
    <load-typesystem name="typesystem_core.xml" generate="no" />

    <rejection class="QXmlAttributes::Attribute"/>
    <rejection class="QDomNode" field-name="impl"/>
    <rejection class="QXmlInputSource" field-name="EndOfData"/>
    <rejection class="QXmlInputSource" field-name="EndOfDocument"/>

    <enum-type name="QDomNode::NodeType"/>
    <enum-type name="QDomNode::EncodingPolicy"/>
    <enum-type name="QDomImplementation::InvalidDataPolicy"/>
<!--
    <enum-type name="QXmlStreamReader::Error" />
    <enum-type name="QXmlStreamReader::TokenType" />
-->

    <value-type name="QDomAttr">
        <modify-function signature="operator=(QDomAttr)" remove="all"/>
        <modify-function signature="nodeType()const" remove="all"/>
    </value-type>

    <value-type name="QDomCDATASection">
        <modify-function signature="operator=(QDomCDATASection)" remove="all"/>
        <modify-function signature="nodeType()const" remove="all"/>
    </value-type>

    <value-type name="QDomCharacterData">
        <modify-function signature="operator=(QDomCharacterData)" remove="all"/>
        <modify-function signature="nodeType()const" remove="all"/>
    </value-type>

    <value-type name="QDomComment">
        <modify-function signature="operator=(QDomComment)" remove="all"/>
        <modify-function signature="nodeType()const" remove="all"/>
    </value-type>

    <template name="qdomdocument_setcontent">
        QString _errorMsg_;
        int _errorLine_ = 0;
        int _errorColumn_ = 0;
        bool _ret_ = %CPPSELF.%FUNCTION_NAME(%ARGUMENT_NAMES, &amp;_errorMsg_, &amp;_errorLine_, &amp;_errorColumn_);
        %PYARG_0 = Shiboken::makeTuple(_ret_, _errorMsg_, _errorLine_, _errorColumn_);
    </template>

    <value-type name="QDomDocument">
        <modify-function signature="nodeType()const" remove="all"/>
        <modify-function signature="operator=(QDomDocument)" remove="all"/>

        <!-- will be replaced in inject code -->
        <modify-function signature="setContent(const QByteArray&amp;, bool, QString*, int*, int*)">
            <modify-argument index="3">
                <remove-argument/>
                <remove-default-expression/>
            </modify-argument>
            <modify-argument index="4">
                <remove-argument/>
                <remove-default-expression/>
            </modify-argument>
            <modify-argument index="5">
                <remove-argument/>
                <remove-default-expression/>
            </modify-argument>
            <inject-code class="target" position="beginning">
                <insert-template name="qdomdocument_setcontent" />
            </inject-code>
        </modify-function>
        <modify-function signature="setContent(const QString&amp;, bool, QString*, int*, int*)">
            <modify-argument index="3">
                <remove-argument/>
                <remove-default-expression/>
            </modify-argument>
            <modify-argument index="4">
                <remove-argument/>
                <remove-default-expression/>
            </modify-argument>
            <modify-argument index="5">
                <remove-argument/>
                <remove-default-expression/>
            </modify-argument>
            <inject-code class="target" position="beginning">
                <insert-template name="qdomdocument_setcontent" />
            </inject-code>
        </modify-function>
        <modify-function signature="setContent(QIODevice*, bool, QString*, int*, int*)">
            <modify-argument index="3">
                <remove-argument/>
                <remove-default-expression/>
            </modify-argument>
            <modify-argument index="4">
                <remove-argument/>
                <remove-default-expression/>
            </modify-argument>
            <modify-argument index="5">
                <remove-argument/>
                <remove-default-expression/>
            </modify-argument>
            <inject-code class="target" position="beginning">
                <insert-template name="qdomdocument_setcontent" />
            </inject-code>
        </modify-function>
        <modify-function signature="setContent(const QByteArray&amp;, QString*, int*, int*)">
            <modify-argument index="2">
                <remove-argument/>
                <remove-default-expression/>
            </modify-argument>
            <modify-argument index="3">
                <remove-argument/>
                <remove-default-expression/>
            </modify-argument>
            <modify-argument index="4">
                <remove-argument/>
                <remove-default-expression/>
            </modify-argument>
            <inject-code class="target" position="beginning">
                <insert-template name="qdomdocument_setcontent" />
            </inject-code>
        </modify-function>
        <modify-function signature="setContent(QIODevice*,QString*,int*,int*)">
            <modify-argument index="2">
                <remove-argument/>
                <remove-default-expression/>
            </modify-argument>
            <modify-argument index="3">
                <remove-argument/>
                <remove-default-expression/>
            </modify-argument>
            <modify-argument index="4">
                <remove-argument/>
                <remove-default-expression/>
            </modify-argument>
            <inject-code class="target" position="beginning">
                <insert-template name="qdomdocument_setcontent" />
            </inject-code>
        </modify-function>
        <modify-function signature="setContent(QXmlInputSource*,bool,QString*,int*,int*)">
            <modify-argument index="3">
                <remove-argument/>
                <remove-default-expression/>
            </modify-argument>
            <modify-argument index="4">
                <remove-argument/>
                <remove-default-expression/>
            </modify-argument>
            <modify-argument index="5">
                <remove-argument/>
                <remove-default-expression/>
            </modify-argument>
            <inject-code class="target" position="beginning">
                <insert-template name="qdomdocument_setcontent" />
            </inject-code>
        </modify-function>
        <modify-function signature="setContent(QXmlInputSource*,QXmlReader*,QString*,int*,int*)">
            <modify-argument index="3">
                <remove-argument/>
                <remove-default-expression/>
            </modify-argument>
            <modify-argument index="4">
                <remove-argument/>
                <remove-default-expression/>
            </modify-argument>
            <modify-argument index="5">
                <remove-argument/>
                <remove-default-expression/>
            </modify-argument>
            <inject-code class="target" position="beginning">
                <insert-template name="qdomdocument_setcontent" />
            </inject-code>
        </modify-function>
        <modify-function signature="setContent(const QString&amp;, QString*,int*,int*)">
            <modify-argument index="2">
                <remove-argument/>
                <remove-default-expression/>
            </modify-argument>
            <modify-argument index="3">
                <remove-argument/>
                <remove-default-expression/>
            </modify-argument>
            <modify-argument index="4">
                <remove-argument/>
                <remove-default-expression/>
            </modify-argument>
            <inject-code class="target" position="beginning">
                <insert-template name="qdomdocument_setcontent" />
            </inject-code>
        </modify-function>
    </value-type>

    <value-type name="QDomDocumentFragment">
        <modify-function signature="nodeType()const" remove="all"/>
        <modify-function signature="operator=(QDomDocumentFragment)" remove="all"/>
    </value-type>

    <value-type name="QDomDocumentType">
        <modify-function signature="nodeType()const" remove="all"/>
        <modify-function signature="operator=(QDomDocumentType)" remove="all"/>
    </value-type>

    <value-type name="QDomEntity">
        <modify-function signature="nodeType()const" remove="all"/>
        <modify-function signature="operator=(QDomEntity)" remove="all"/>
    </value-type>

    <value-type name="QDomEntityReference">
        <modify-function signature="nodeType()const" remove="all"/>
        <modify-function signature="operator=(QDomEntityReference)" remove="all"/>
    </value-type>

    <value-type name="QDomImplementation">
        <modify-function signature="operator=(QDomImplementation)" remove="all"/>
    </value-type>

    <value-type name="QDomNamedNodeMap">
        <modify-function signature="operator=(QDomNamedNodeMap)" remove="all"/>
    </value-type>

    <value-type name="QDomNode">
        <modify-function signature="operator=(QDomNode)" remove="all"/>
        <modify-function signature="save(QTextStream&amp;, int)const" allow-thread="yes"/>
        <modify-function signature="save(QTextStream&amp;, int, QDomNode::EncodingPolicy)const" allow-thread="yes"/>
    </value-type>

    <value-type name="QDomNodeList">
        <modify-function signature="operator=(const QDomNodeList &amp;)" remove="all"/>
    </value-type>

    <value-type name="QDomNotation">
        <modify-function signature="nodeType()const" remove="all"/>
        <modify-function signature="operator=(QDomNotation)" remove="all"/>
    </value-type>

    <value-type name="QDomProcessingInstruction">
        <modify-function signature="nodeType()const" remove="all"/>
        <modify-function signature="operator=(QDomProcessingInstruction)" remove="all"/>
    </value-type>

    <value-type name="QDomText">
        <modify-function signature="nodeType()const" remove="all"/>
        <modify-function signature="operator=(const QDomText &amp;)" remove="all"/>
    </value-type>

    <value-type name="QXmlParseException"/>

<!-- These are defined in QtCore
    <value-type name="QXmlStreamAttribute"/>
    <value-type name="QXmlStreamAttributes"/>

    <value-type name="QXmlStreamNamespaceDeclaration"/>
    <value-type name="QXmlStreamNotationDeclaration"/>
    <value-type name="QXmlStreamEntityDeclaration"/>
-->

    <value-type name="QXmlAttributes"/>

    <!-- FIXME: This needs to be changed to value-type if
         QXmlNamespaceSupport is ever passed by value -->
    <object-type name="QXmlNamespaceSupport"/>

    <value-type name="QDomElement"/>

    <interface-type name="QXmlContentHandler">
        <modify-function signature="setDocumentLocator(QXmlLocator*)">
            <modify-argument index="1">
                <define-ownership owner="c++"/>
            </modify-argument>
        </modify-function>
    </interface-type>
    <interface-type name="QXmlDTDHandler"/>
    <interface-type name="QXmlDeclHandler"/>
    <interface-type name="QXmlEntityResolver"/>
    <interface-type name="QXmlErrorHandler"/>
    <interface-type name="QXmlLexicalHandler"/>

    <object-type name="QXmlDefaultHandler">
        <modify-function signature="setDocumentLocator(QXmlLocator*)">
            <modify-argument index="1">
                <define-ownership owner="c++"/>
            </modify-argument>
        </modify-function>
    </object-type>
    <object-type name="QXmlInputSource"/>
    <object-type name="QXmlLocator"/>
    <object-type name="QXmlSimpleReader">
        <modify-function signature="property(QString,bool*)const" remove="all"/>
        <modify-function signature="parse(const QXmlInputSource*,bool)">
            <modify-argument index="1" invalidate-after-use="yes"/>
        </modify-function>

        <modify-function signature="setContentHandler(QXmlContentHandler*)">
            <modify-argument index="1">
                <parent index="this" action="add"/>
            </modify-argument>
        </modify-function>
        <modify-function signature="setDTDHandler(QXmlDTDHandler*)">
            <modify-argument index="1">
                <parent index="this" action="add"/>
            </modify-argument>
        </modify-function>
        <modify-function signature="setDeclHandler(QXmlDeclHandler*)">
            <modify-argument index="1">
                <parent index="this" action="add"/>
            </modify-argument>
        </modify-function>
        <modify-function signature="setEntityResolver(QXmlEntityResolver*)">
            <modify-argument index="1">
                <parent index="this" action="add"/>
            </modify-argument>
        </modify-function>
        <modify-function signature="setErrorHandler(QXmlErrorHandler*)">
            <modify-argument index="1">
                <parent index="this" action="add"/>
            </modify-argument>
        </modify-function>
        <modify-function signature="setLexicalHandler(QXmlLexicalHandler*)">
            <modify-argument index="1">
                <parent index="this" action="add"/>
            </modify-argument>
        </modify-function>
    </object-type>

<!-- These are defined already in QtCore
    <object-type name="QXmlStreamReader">
    </object-type>

    <object-type name="QXmlStreamWriter">
    </object-type>
-->

    <object-type name="QXmlReader">
        <modify-function signature="parse(const QXmlInputSource*)">
            <modify-argument index="1" invalidate-after-use="yes"/>
        </modify-function>

<!-- FIXME
        <modify-function signature="feature(QString,bool*)const">
            <modify-argument index="2">
                <remove-default-expression/>
                <remove-argument/>
            </modify-argument>
            <modify-argument index="return">
                <replace-type modified-type="boost::python::object" />
            </modify-argument>
            <inject-code class="native" position="beginning">
                <insert-template name="bool*_at_end_fix_beginning"/>
            </inject-code>
            <inject-code class="native" position="end">
                <insert-template name="bool*_fix_end" />
            </inject-code>
        </modify-function>
-->
<!-- FIXME
        <modify-function signature="property(QString,bool*)const" remove="all">
            <modify-argument index="2">
                <remove-default-expression/>
                <remove-argument/>
            </modify-argument>
            <modify-argument index="return">
                <replace-type modified-type="boost::python::object" />
            </modify-argument>
            <inject-code class="native" position="beginning">
                <insert-template name="bool*_at_end_fix_beginning"/>
            </inject-code>
            <inject-code class="native" position="end">
                <insert-template name="bool*_fix_end" />
            </inject-code>
        </modify-function>
-->
    </object-type>

</typesystem>
